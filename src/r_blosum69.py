from functools import lru_cache


B_GAP = b'-'

WEIGHTS = {
    b'-': 0.9,
    b'A': 0.1,
    b'R': 0.1,
    b'N': 0.1,
    b'D': 0.1,
    b'C': 0.1,
    b'Q': 0.1,
    b'E': 0.1,
    b'G': 0.1,
    b'H': 0.1,
    b'I': 0.1,
    b'L': 0.1,
    b'K': 0.1,
    b'M': 0.1,
    b'F': 0.1,
    b'P': 0.1,
    b'S': 0.1,
    b'T': 0.1,
    b'W': 0.1,
    b'Y': 0.1,
    b'V': 0.1,
    b'B': 0.1,
    b'Z': 0.1,
    b'X': 0.1,
    b'*': 0.1
}


CHAR_RBLOSUM69P13 = {
    (b'A', b'A'): 5,
    (b'A', b'R'): -1,
    (b'A', b'N'): -1,
    (b'A', b'D'): -2,
    (b'A', b'C'): -1,
    (b'A', b'Q'): -1,
    (b'A', b'E'): -1,
    (b'A', b'G'): 0,
    (b'A', b'H'): -2,
    (b'A', b'I'): -1,
    (b'A', b'L'): -1,
    (b'A', b'K'): -1,
    (b'A', b'M'): 0,
    (b'A', b'F'): -2,
    (b'A', b'P'): -1,
    (b'A', b'S'): 1,
    (b'A', b'T'): 0,
    (b'A', b'W'): -2,
    (b'A', b'Y'): -2,
    (b'A', b'V'): 0,
    (b'A', b'B'): -2,
    (b'A', b'Z'): -1,
    (b'A', b'X'): 0,
    (b'A', b'*'): -5,
    (b'R', b'A'): -1,
    (b'R', b'R'): 6,
    (b'R', b'N'): 0,
    (b'R', b'D'): -1,
    (b'R', b'C'): -3,
    (b'R', b'Q'): 1,
    (b'R', b'E'): 1,
    (b'R', b'G'): -2,
    (b'R', b'H'): 0,
    (b'R', b'I'): -2,
    (b'R', b'L'): -2,
    (b'R', b'K'): 3,
    (b'R', b'M'): -1,
    (b'R', b'F'): -3,
    (b'R', b'P'): -1,
    (b'R', b'S'): -1,
    (b'R', b'T'): -1,
    (b'R', b'W'): -1,
    (b'R', b'Y'): -2,
    (b'R', b'V'): -2,
    (b'R', b'B'): 0,
    (b'R', b'Z'): 1,
    (b'R', b'X'): -1,
    (b'R', b'*'): -5,
    (b'N', b'A'): -1,
    (b'N', b'R'): 0,
    (b'N', b'N'): 7,
    (b'N', b'D'): 2,
    (b'N', b'C'): -2,
    (b'N', b'Q'): 0,
    (b'N', b'E'): 0,
    (b'N', b'G'): 0,
    (b'N', b'H'): 1,
    (b'N', b'I'): -3,
    (b'N', b'L'): -3,
    (b'N', b'K'): 0,
    (b'N', b'M'): -2,
    (b'N', b'F'): -2,
    (b'N', b'P'): -1,
    (b'N', b'S'): 1,
    (b'N', b'T'): 0,
    (b'N', b'W'): -2,
    (b'N', b'Y'): -1,
    (b'N', b'V'): -2,
    (b'N', b'B'): 4,
    (b'N', b'Z'): 0,
    (b'N', b'X'): -1,
    (b'N', b'*'): -5,
    (b'D', b'A'): -2,
    (b'D', b'R'): -1,
    (b'D', b'N'): 2,
    (b'D', b'D'): 7,
    (b'D', b'C'): -3,
    (b'D', b'Q'): 1,
    (b'D', b'E'): 2,
    (b'D', b'G'): -1,
    (b'D', b'H'): -1,
    (b'D', b'I'): -4,
    (b'D', b'L'): -3,
    (b'D', b'K'): 0,
    (b'D', b'M'): -3,
    (b'D', b'F'): -3,
    (b'D', b'P'): -1,
    (b'D', b'S'): 0,
    (b'D', b'T'): -1,
    (b'D', b'W'): -3,
    (b'D', b'Y'): -3,
    (b'D', b'V'): -3,
    (b'D', b'B'): 5,
    (b'D', b'Z'): 2,
    (b'D', b'X'): -1,
    (b'D', b'*'): -5,
    (b'C', b'A'): -1,
    (b'C', b'R'): -3,
    (b'C', b'N'): -2,
    (b'C', b'D'): -3,
    (b'C', b'C'): 12,
    (b'C', b'Q'): -3,
    (b'C', b'E'): -4,
    (b'C', b'G'): -3,
    (b'C', b'H'): -2,
    (b'C', b'I'): -2,
    (b'C', b'L'): -2,
    (b'C', b'K'): -3,
    (b'C', b'M'): -2,
    (b'C', b'F'): -1,
    (b'C', b'P'): -3,
    (b'C', b'S'): -2,
    (b'C', b'T'): -2,
    (b'C', b'W'): -3,
    (b'C', b'Y'): -2,
    (b'C', b'V'): -2,
    (b'C', b'B'): -3,
    (b'C', b'Z'): -3,
    (b'C', b'X'): -2,
    (b'C', b'*'): -5,
    (b'Q', b'A'): -1,
    (b'Q', b'R'): 1,
    (b'Q', b'N'): 0,
    (b'Q', b'D'): 1,
    (b'Q', b'C'): -3,
    (b'Q', b'Q'): 5,
    (b'Q', b'E'): 2,
    (b'Q', b'G'): -2,
    (b'Q', b'H'): 0,
    (b'Q', b'I'): -2,
    (b'Q', b'L'): -2,
    (b'Q', b'K'): 1,
    (b'Q', b'M'): 0,
    (b'Q', b'F'): -2,
    (b'Q', b'P'): -1,
    (b'Q', b'S'): 0,
    (b'Q', b'T'): 0,
    (b'Q', b'W'): -1,
    (b'Q', b'Y'): -1,
    (b'Q', b'V'): -2,
    (b'Q', b'B'): 1,
    (b'Q', b'Z'): 3,
    (b'Q', b'X'): 0,
    (b'Q', b'*'): -5,
    (b'E', b'A'): -1,
    (b'E', b'R'): 1,
    (b'E', b'N'): 0,
    (b'E', b'D'): 2,
    (b'E', b'C'): -4,
    (b'E', b'Q'): 2,
    (b'E', b'E'): 6,
    (b'E', b'G'): -2,
    (b'E', b'H'): -1,
    (b'E', b'I'): -3,
    (b'E', b'L'): -3,
    (b'E', b'K'): 1,
    (b'E', b'M'): -2,
    (b'E', b'F'): -3,
    (b'E', b'P'): 0,
    (b'E', b'S'): -1,
    (b'E', b'T'): -1,
    (b'E', b'W'): -2,
    (b'E', b'Y'): -2,
    (b'E', b'V'): -2,
    (b'E', b'B'): 1,
    (b'E', b'Z'): 4,
    (b'E', b'X'): -1,
    (b'E', b'*'): -5,
    (b'G', b'A'): 0,
    (b'G', b'R'): -2,
    (b'G', b'N'): 0,
    (b'G', b'D'): -1,
    (b'G', b'C'): -3,
    (b'G', b'Q'): -2,
    (b'G', b'E'): -2,
    (b'G', b'G'): 7,
    (b'G', b'H'): -2,
    (b'G', b'I'): -4,
    (b'G', b'L'): -4,
    (b'G', b'K'): -2,
    (b'G', b'M'): -3,
    (b'G', b'F'): -3,
    (b'G', b'P'): -2,
    (b'G', b'S'): 0,
    (b'G', b'T'): -2,
    (b'G', b'W'): -3,
    (b'G', b'Y'): -3,
    (b'G', b'V'): -3,
    (b'G', b'B'): -1,
    (b'G', b'Z'): -2,
    (b'G', b'X'): -1,
    (b'G', b'*'): -5,
    (b'H', b'A'): -2,
    (b'H', b'R'): 0,
    (b'H', b'N'): 1,
    (b'H', b'D'): -1,
    (b'H', b'C'): -2,
    (b'H', b'Q'): 0,
    (b'H', b'E'): -1,
    (b'H', b'G'): -2,
    (b'H', b'H'): 10,
    (b'H', b'I'): -3,
    (b'H', b'L'): -3,
    (b'H', b'K'): 0,
    (b'H', b'M'): -2,
    (b'H', b'F'): -2,
    (b'H', b'P'): -2,
    (b'H', b'S'): -1,
    (b'H', b'T'): -1,
    (b'H', b'W'): -1,
    (b'H', b'Y'): 1,
    (b'H', b'V'): -3,
    (b'H', b'B'): 0,
    (b'H', b'Z'): 0,
    (b'H', b'X'): -1,
    (b'H', b'*'): -5,
    (b'I', b'A'): -1,
    (b'I', b'R'): -2,
    (b'I', b'N'): -3,
    (b'I', b'D'): -4,
    (b'I', b'C'): -2,
    (b'I', b'Q'): -2,
    (b'I', b'E'): -3,
    (b'I', b'G'): -4,
    (b'I', b'H'): -3,
    (b'I', b'I'): 5,
    (b'I', b'L'): 2,
    (b'I', b'K'): -2,
    (b'I', b'M'): 2,
    (b'I', b'F'): 0,
    (b'I', b'P'): -3,
    (b'I', b'S'): -2,
    (b'I', b'T'): -1,
    (b'I', b'W'): -1,
    (b'I', b'Y'): -1,
    (b'I', b'V'): 3,
    (b'I', b'B'): -3,
    (b'I', b'Z'): -3,
    (b'I', b'X'): -1,
    (b'I', b'*'): -5,
    (b'L', b'A'): -1,
    (b'L', b'R'): -2,
    (b'L', b'N'): -3,
    (b'L', b'D'): -3,
    (b'L', b'C'): -2,
    (b'L', b'Q'): -2,
    (b'L', b'E'): -3,
    (b'L', b'G'): -4,
    (b'L', b'H'): -3,
    (b'L', b'I'): 2,
    (b'L', b'L'): 5,
    (b'L', b'K'): -2,
    (b'L', b'M'): 3,
    (b'L', b'F'): 1,
    (b'L', b'P'): -3,
    (b'L', b'S'): -3,
    (b'L', b'T'): -2,
    (b'L', b'W'): 0,
    (b'L', b'Y'): -1,
    (b'L', b'V'): 1,
    (b'L', b'B'): -3,
    (b'L', b'Z'): -2,
    (b'L', b'X'): -1,
    (b'L', b'*'): -5,
    (b'K', b'A'): -1,
    (b'K', b'R'): 3,
    (b'K', b'N'): 0,
    (b'K', b'D'): 0,
    (b'K', b'C'): -3,
    (b'K', b'Q'): 1,
    (b'K', b'E'): 1,
    (b'K', b'G'): -2,
    (b'K', b'H'): 0,
    (b'K', b'I'): -2,
    (b'K', b'L'): -2,
    (b'K', b'K'): 6,
    (b'K', b'M'): -1,
    (b'K', b'F'): -3,
    (b'K', b'P'): -1,
    (b'K', b'S'): -1,
    (b'K', b'T'): 0,
    (b'K', b'W'): -2,
    (b'K', b'Y'): -2,
    (b'K', b'V'): -2,
    (b'K', b'B'): 0,
    (b'K', b'Z'): 1,
    (b'K', b'X'): -1,
    (b'K', b'*'): -5,
    (b'M', b'A'): 0,
    (b'M', b'R'): -1,
    (b'M', b'N'): -2,
    (b'M', b'D'): -3,
    (b'M', b'C'): -2,
    (b'M', b'Q'): 0,
    (b'M', b'E'): -2,
    (b'M', b'G'): -3,
    (b'M', b'H'): -2,
    (b'M', b'I'): 2,
    (b'M', b'L'): 3,
    (b'M', b'K'): -1,
    (b'M', b'M'): 6,
    (b'M', b'F'): 1,
    (b'M', b'P'): -2,
    (b'M', b'S'): -1,
    (b'M', b'T'): -1,
    (b'M', b'W'): 0,
    (b'M', b'Y'): -1,
    (b'M', b'V'): 1,
    (b'M', b'B'): -2,
    (b'M', b'Z'): -1,
    (b'M', b'X'): 0,
    (b'M', b'*'): -5,
    (b'F', b'A'): -2,
    (b'F', b'R'): -3,
    (b'F', b'N'): -2,
    (b'F', b'D'): -3,
    (b'F', b'C'): -1,
    (b'F', b'Q'): -2,
    (b'F', b'E'): -3,
    (b'F', b'G'): -3,
    (b'F', b'H'): -2,
    (b'F', b'I'): 0,
    (b'F', b'L'): 1,
    (b'F', b'K'): -3,
    (b'F', b'M'): 1,
    (b'F', b'F'): 8,
    (b'F', b'P'): -2,
    (b'F', b'S'): -2,
    (b'F', b'T'): -2,
    (b'F', b'W'): 2,
    (b'F', b'Y'): 3,
    (b'F', b'V'): 0,
    (b'F', b'B'): -3,
    (b'F', b'Z'): -3,
    (b'F', b'X'): -1,
    (b'F', b'*'): -5,
    (b'P', b'A'): -1,
    (b'P', b'R'): -1,
    (b'P', b'N'): -1,
    (b'P', b'D'): -1,
    (b'P', b'C'): -3,
    (b'P', b'Q'): -1,
    (b'P', b'E'): 0,
    (b'P', b'G'): -2,
    (b'P', b'H'): -2,
    (b'P', b'I'): -3,
    (b'P', b'L'): -3,
    (b'P', b'K'): -1,
    (b'P', b'M'): -2,
    (b'P', b'F'): -2,
    (b'P', b'P'): 9,
    (b'P', b'S'): 0,
    (b'P', b'T'): -1,
    (b'P', b'W'): -2,
    (b'P', b'Y'): -2,
    (b'P', b'V'): -2,
    (b'P', b'B'): -1,
    (b'P', b'Z'): -1,
    (b'P', b'X'): -1,
    (b'P', b'*'): -5,
    (b'S', b'A'): 1,
    (b'S', b'R'): -1,
    (b'S', b'N'): 1,
    (b'S', b'D'): 0,
    (b'S', b'C'): -2,
    (b'S', b'Q'): 0,
    (b'S', b'E'): -1,
    (b'S', b'G'): 0,
    (b'S', b'H'): -1,
    (b'S', b'I'): -2,
    (b'S', b'L'): -3,
    (b'S', b'K'): -1,
    (b'S', b'M'): -1,
    (b'S', b'F'): -2,
    (b'S', b'P'): 0,
    (b'S', b'S'): 4,
    (b'S', b'T'): 2,
    (b'S', b'W'): -2,
    (b'S', b'Y'): -2,
    (b'S', b'V'): -1,
    (b'S', b'B'): 0,
    (b'S', b'Z'): 0,
    (b'S', b'X'): 0,
    (b'S', b'*'): -5,
    (b'T', b'A'): 0,
    (b'T', b'R'): -1,
    (b'T', b'N'): 0,
    (b'T', b'D'): -1,
    (b'T', b'C'): -2,
    (b'T', b'Q'): 0,
    (b'T', b'E'): -1,
    (b'T', b'G'): -2,
    (b'T', b'H'): -1,
    (b'T', b'I'): -1,
    (b'T', b'L'): -2,
    (b'T', b'K'): 0,
    (b'T', b'M'): -1,
    (b'T', b'F'): -2,
    (b'T', b'P'): -1,
    (b'T', b'S'): 2,
    (b'T', b'T'): 5,
    (b'T', b'W'): -1,
    (b'T', b'Y'): -2,
    (b'T', b'V'): 0,
    (b'T', b'B'): 0,
    (b'T', b'Z'): 0,
    (b'T', b'X'): 0,
    (b'T', b'*'): -5,
    (b'W', b'A'): -2,
    (b'W', b'R'): -1,
    (b'W', b'N'): -2,
    (b'W', b'D'): -3,
    (b'W', b'C'): -3,
    (b'W', b'Q'): -1,
    (b'W', b'E'): -2,
    (b'W', b'G'): -3,
    (b'W', b'H'): -1,
    (b'W', b'I'): -1,
    (b'W', b'L'): 0,
    (b'W', b'K'): -2,
    (b'W', b'M'): 0,
    (b'W', b'F'): 2,
    (b'W', b'P'): -2,
    (b'W', b'S'): -2,
    (b'W', b'T'): -1,
    (b'W', b'W'): 13,
    (b'W', b'Y'): 3,
    (b'W', b'V'): -2,
    (b'W', b'B'): -2,
    (b'W', b'Z'): -2,
    (b'W', b'X'): -1,
    (b'W', b'*'): -5,
    (b'Y', b'A'): -2,
    (b'Y', b'R'): -2,
    (b'Y', b'N'): -1,
    (b'Y', b'D'): -3,
    (b'Y', b'C'): -2,
    (b'Y', b'Q'): -1,
    (b'Y', b'E'): -2,
    (b'Y', b'G'): -3,
    (b'Y', b'H'): 1,
    (b'Y', b'I'): -1,
    (b'Y', b'L'): -1,
    (b'Y', b'K'): -2,
    (b'Y', b'M'): -1,
    (b'Y', b'F'): 3,
    (b'Y', b'P'): -2,
    (b'Y', b'S'): -2,
    (b'Y', b'T'): -2,
    (b'Y', b'W'): 3,
    (b'Y', b'Y'): 9,
    (b'Y', b'V'): -1,
    (b'Y', b'B'): -2,
    (b'Y', b'Z'): -2,
    (b'Y', b'X'): -1,
    (b'Y', b'*'): -5,
    (b'V', b'A'): 0,
    (b'V', b'R'): -2,
    (b'V', b'N'): -2,
    (b'V', b'D'): -3,
    (b'V', b'C'): -2,
    (b'V', b'Q'): -2,
    (b'V', b'E'): -2,
    (b'V', b'G'): -3,
    (b'V', b'H'): -3,
    (b'V', b'I'): 3,
    (b'V', b'L'): 1,
    (b'V', b'K'): -2,
    (b'V', b'M'): 1,
    (b'V', b'F'): 0,
    (b'V', b'P'): -2,
    (b'V', b'S'): -1,
    (b'V', b'T'): 0,
    (b'V', b'W'): -2,
    (b'V', b'Y'): -1,
    (b'V', b'V'): 4,
    (b'V', b'B'): -3,
    (b'V', b'Z'): -2,
    (b'V', b'X'): -1,
    (b'V', b'*'): -5,
    (b'B', b'A'): -2,
    (b'B', b'R'): 0,
    (b'B', b'N'): 4,
    (b'B', b'D'): 5,
    (b'B', b'C'): -3,
    (b'B', b'Q'): 1,
    (b'B', b'E'): 1,
    (b'B', b'G'): -1,
    (b'B', b'H'): 0,
    (b'B', b'I'): -3,
    (b'B', b'L'): -3,
    (b'B', b'K'): 0,
    (b'B', b'M'): -2,
    (b'B', b'F'): -3,
    (b'B', b'P'): -1,
    (b'B', b'S'): 0,
    (b'B', b'T'): 0,
    (b'B', b'W'): -2,
    (b'B', b'Y'): -2,
    (b'B', b'V'): -3,
    (b'B', b'B'): 4,
    (b'B', b'Z'): 1,
    (b'B', b'X'): -1,
    (b'B', b'*'): -5,
    (b'Z', b'A'): -1,
    (b'Z', b'R'): 1,
    (b'Z', b'N'): 0,
    (b'Z', b'D'): 2,
    (b'Z', b'C'): -3,
    (b'Z', b'Q'): 3,
    (b'Z', b'E'): 4,
    (b'Z', b'G'): -2,
    (b'Z', b'H'): 0,
    (b'Z', b'I'): -3,
    (b'Z', b'L'): -2,
    (b'Z', b'K'): 1,
    (b'Z', b'M'): -1,
    (b'Z', b'F'): -3,
    (b'Z', b'P'): -1,
    (b'Z', b'S'): 0,
    (b'Z', b'T'): 0,
    (b'Z', b'W'): -2,
    (b'Z', b'Y'): -2,
    (b'Z', b'V'): -2,
    (b'Z', b'B'): 1,
    (b'Z', b'Z'): 4,
    (b'Z', b'X'): -1,
    (b'Z', b'*'): -5,
    (b'X', b'A'): 0,
    (b'X', b'R'): -1,
    (b'X', b'N'): -1,
    (b'X', b'D'): -1,
    (b'X', b'C'): -2,
    (b'X', b'Q'): 0,
    (b'X', b'E'): -1,
    (b'X', b'G'): -1,
    (b'X', b'H'): -1,
    (b'X', b'I'): -1,
    (b'X', b'L'): -1,
    (b'X', b'K'): -1,
    (b'X', b'M'): 0,
    (b'X', b'F'): -1,
    (b'X', b'P'): -1,
    (b'X', b'S'): 0,
    (b'X', b'T'): 0,
    (b'X', b'W'): -1,
    (b'X', b'Y'): -1,
    (b'X', b'V'): -1,
    (b'X', b'B'): -1,
    (b'X', b'Z'): -1,
    (b'X', b'X'): -1,
    (b'X', b'*'): -5,
    (b'*', b'A'): -5,
    (b'*', b'R'): -5,
    (b'*', b'N'): -5,
    (b'*', b'D'): -5,
    (b'*', b'C'): -5,
    (b'*', b'Q'): -5,
    (b'*', b'E'): -5,
    (b'*', b'G'): -5,
    (b'*', b'H'): -5,
    (b'*', b'I'): -5,
    (b'*', b'L'): -5,
    (b'*', b'K'): -5,
    (b'*', b'M'): -5,
    (b'*', b'F'): -5,
    (b'*', b'P'): -5,
    (b'*', b'S'): -5,
    (b'*', b'T'): -5,
    (b'*', b'W'): -5,
    (b'*', b'Y'): -5,
    (b'*', b'V'): -5,
    (b'*', b'B'): -5,
    (b'*', b'Z'): -5,
    (b'*', b'X'): -5,
    (b'*', b'*'): 1,
    (B_GAP, b'A'): -8,
    (B_GAP, b'R'): -8,
    (B_GAP, b'N'): -8,
    (B_GAP, b'D'): -8,
    (B_GAP, b'C'): -8,
    (B_GAP, b'Q'): -8,
    (B_GAP, b'E'): -8,
    (B_GAP, b'G'): -8,
    (B_GAP, b'H'): -8,
    (B_GAP, b'I'): -8,
    (B_GAP, b'L'): -8,
    (B_GAP, b'K'): -8,
    (B_GAP, b'M'): -8,
    (B_GAP, b'F'): -8,
    (B_GAP, b'P'): -8,
    (B_GAP, b'S'): -8,
    (B_GAP, b'T'): -8,
    (B_GAP, b'W'): -8,
    (B_GAP, b'Y'): -8,
    (B_GAP, b'V'): -8,
    (B_GAP, b'B'): -8,
    (B_GAP, b'Z'): -8,
    (B_GAP, b'X'): -8,
    (b'A', B_GAP): -8,
    (b'R', B_GAP): -8,
    (b'N', B_GAP): -8,
    (b'D', B_GAP): -8,
    (b'C', B_GAP): -8,
    (b'Q', B_GAP): -8,
    (b'E', B_GAP): -8,
    (b'G', B_GAP): -8,
    (b'H', B_GAP): -8,
    (b'I', B_GAP): -8,
    (b'L', B_GAP): -8,
    (b'K', B_GAP): -8,
    (b'M', B_GAP): -8,
    (b'F', B_GAP): -8,
    (b'P', B_GAP): -8,
    (b'S', B_GAP): -8,
    (b'T', B_GAP): -8,
    (b'W', B_GAP): -8,
    (b'Y', B_GAP): -8,
    (b'V', B_GAP): -8,
    (b'B', B_GAP): -8,
    (b'Z', B_GAP): -8,
    (b'X', B_GAP): -8,
    (B_GAP, B_GAP): -12,
}

@lru_cache(maxsize=None)
def tuple_score(residue_a, residue_b):
    return CHAR_RBLOSUM69P13.get((residue_a, residue_b), CHAR_RBLOSUM69P13.get((residue_b, residue_a), -5))